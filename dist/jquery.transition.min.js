/*!
 * jquery.transition - A custom jQuery event that executes user-defined callback functions during an elements CSS transition.
 * 
 * Copyright (c) 2015 Erik Nielsen
 * 
 * Licensed under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 * 
 * Project home:
 *    https://nielse63.github.io/jquery.transition/
 * 
 * Version:  0.1.0
 * 
 */

!function(a){var b=window.Chicago||{utils:{now:Date.now||function(){return(new Date).getTime()},uid:function(a){var c=b.utils.now();return a=a||"",a+"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=(c+16*Math.random())%16|0;return c=Math.floor(c/16),("x"===a?b:3&b|8).toString(16)})},is:{numeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},integer:function(a){return a&&Number(a)===a&&a%1===0},"float":function(a){return a&&Number(a)===a&&a%1!==0}}},$:window.jQuery||null};if("function"==typeof define&&define.amd&&define("chicago",function(){return b.load=function(a,c,d,e){var f=a.split(","),g=[],h=(e.config&&e.config.chicago&&e.config.chicago.base?e.config.chicago.base:"").replace(/\/+$/g,"");if(!h)throw new Error("Please define base path to jquery.transition in the requirejs config.");for(var i=0;i<f.length;){var j=f[i].replace(/\./g,"/");g.push(h+"/"+j),i+=1}c(g,function(){d(b)})},b}),window&&window.jQuery)return a(b,window,window.document);if(!window.jQuery)throw new Error("jquery.transition requires jQuery")}(function(a,b,c){a.$win=a.$(b),a.$doc=a.$(c),a.events||(a.events={}),a.events.transition={defaults:{start:function(a){},progress:function(a,b,c){},complete:function(a){}},setup:function(b,c,d){function e(b){var c=k.css(b).replace(/px/gi,"");return a.utils.is.numeric(c)&&(c=parseFloat(c),a.utils.is["float"](c)&&(c=c.toFixed(2))),c}function f(a){return parseInt(1e3*parseFloat(a.replace("s","")),10)}function g(){var a=k.data(l.info);if(a)return a;a={};for(var b=k.css("transition").split(","),c=0;c<b.length;c++){var d=b[c].trim().split(" "),g=d[0];a.hasOwnProperty(g)||(a[g]={duration:f(d[1]),"function":d[2],delay:f(d[3]),value:e(g)})}return k.data(l.info,a),a}function h(a){var b=l.base+"."+a,c={bindStart:b+".did.bind.start",didStart:b+".did.start",didStartAt:b+".did.start.at",progressValue:b+".progress.value"};for(var d in c){var e=c[d];k.removeData(e)}}function i(){a.$.event.special.transition.teardown.call(k[0])}var j=a.utils.uid("transition"),k=a.$(this),l={uid:"chicago.event.transition.uid",base:"chicago.event."+j,event:"chicago.event."+j+".event",info:"chicago.event."+j+".info"},m=15;b=a.$.extend({},a.$.event.special.transition.defaults,b),k.data(l.uid,j);var n=k.data(l.event);return n||(n={},n.interval=setInterval(function(){function c(a,c){var d=l.base+"."+c.property+".progress.value";k.data(d,c.cssValue),b.progress.call(k[0],c.property,c.elapsedTime,c.cssValue)}var d=g();for(var f in d){var j=d[f],m=j.value,n=e(f),o=l.base+"."+f,p=a.utils.now(),q={bindStart:o+".did.bind.start",didStart:o+".did.start",didStartAt:o+".did.start.at",progressValue:o+".progress.value"},r={start:o+".start",progress:o+".progress",complete:o+".complete"},s=k.data(q.bindStart),t=k.data(q.didStart),u=k.data(q.didStartAt),v=k.data(q.progressValue);if(u&&u<p-j.duration&&v===n)return d=k.data(l.info),delete d[f],k.data(l.info,d),h(f),b.complete.call(k[0],f),Object.keys(d).length||(k.trigger("transition"),setTimeout(i)),!1;s||(k.data(q.bindStart,!0),k.one(r.start,function(a,d){b.start.call(k[0],d.property),k.on(l.base+"."+d.property+".progress",c)})),void 0===t&&n!==m?(k.data(q.didStart,!0).data(q.didStartAt,p),k.trigger(r.start,{property:f})):t&&n!==m&&k.trigger(r.progress,{property:f,cssValue:n,elapsedTime:p-k.data(q.didStartAt)})}},m),k.data(l.event,n)),!0},teardown:function(){var b=a.$(this).data("chicago.event.transition.uid"),c={uid:"chicago.event.transition.uid",base:"chicago.event."+b,event:"chicago.event."+b+".event",info:"chicago.event."+b+".info"};for(var d in c){var e=c[d],f=a.$(this).data(e);"event"===d&&clearInterval(f.interval),f&&a.$(this).removeData(e)}}},function(){a.$.event.special.transition=a.events.transition,a.$.fn.transition=function(b,c){return this.each(function(){a.$(this).on("transition",b,c)})}}()});